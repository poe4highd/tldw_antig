# é‡æ–°ç”Ÿæˆæ‘˜è¦è„šæœ¬è¯´æ˜

**æ–‡ä»¶**: `backend/tests/test_regenerate_summaries.py`
**ç”¨é€”**: å¯¹æ•°æ®åº“ä¸­æœ€è¿‘ N ä¸ªå·²å®Œæˆè§†é¢‘é‡æ–°è°ƒç”¨ LLM ç”Ÿæˆæ‘˜è¦ï¼Œå¹¶éªŒè¯æ—¶é—´æˆ³æ˜¯å¦ä¸¥æ ¼é€’å¢ã€‚

---

## èƒŒæ™¯

2026-02-25 ä¿®å¤äº† AI æ‘˜è¦æ—¶é—´æˆ³ä¹±åºé—®é¢˜ï¼ˆ`processor.py` prompt æ–°å¢çº¦æŸ + åå¤„ç†æ’åºï¼‰ï¼Œä½†å·²å…¥åº“çš„æ—§æ•°æ®éœ€è¦æ‰‹åŠ¨è§¦å‘é‡æ–°ç”Ÿæˆæ‰èƒ½ä¿®æ­£ã€‚

---

## ä½¿ç”¨æ–¹æ³•

åœ¨ `backend/` ç›®å½•ä¸‹æ‰§è¡Œï¼š

```bash
# é¢„è§ˆï¼ˆä¸å†™å…¥ä»»ä½•æ•°æ®ï¼Œæ¨èå…ˆæ‰§è¡Œç¡®è®¤ï¼‰
python tests/test_regenerate_summaries.py --dry-run

# æ­£å¼æ‰§è¡Œï¼Œé‡æ–°ç”Ÿæˆæœ€è¿‘ 10 ä¸ªè§†é¢‘
python tests/test_regenerate_summaries.py

# æŒ‡å®šæ•°é‡
python tests/test_regenerate_summaries.py --limit 5
```

---

## æ•°æ®æ¥æºä¼˜å…ˆçº§

æ¯ä¸ªè§†é¢‘æŒ‰ä»¥ä¸‹é¡ºåºè·å– `paragraphs`ï¼ˆå­—å¹•æ®µè½ï¼‰ï¼š

1. `backend/results/{task_id}.json`ï¼ˆæœ¬åœ°ç¼“å­˜æ–‡ä»¶ï¼‰
2. Supabase `videos.report_data.paragraphs`ï¼ˆæ•°æ®åº“ï¼‰

---

## è¾“å‡ºç¤ºä¾‹

```
============================================================
  é‡æ–°ç”Ÿæˆæœ€è¿‘ 10 ä¸ªè§†é¢‘çš„æ‘˜è¦
  æ—¶é—´: 2026-02-25 14:30:00
============================================================

[1/10] ZrwR5gJKZ0U  ç¨å¾®æƒ³èµ·ä¸€äº›
         æ—¶é—´æˆ³: ['01:00', '02:00', '09:00', '11:00', '16:58', '17:30', '19:00']  âœ… æœ‰åº
         æ¡ç›®æ•°: 7
         ğŸ’¾  æœ¬åœ° JSON å·²æ›´æ–°: ZrwR5gJKZ0U.json
         â˜ï¸   Supabase å·²æ›´æ–°

============================================================
  æ±‡æ€»æŠ¥å‘Š
============================================================
  æˆåŠŸ:    10
  è·³è¿‡:    0
  å¤±è´¥:    0
  æ—¶é—´ä¹±åº: 0
  âœ…  æ‰€æœ‰æˆåŠŸè§†é¢‘æ—¶é—´æˆ³å‡ä¸ºé€’å¢é¡ºåº
============================================================
```

---

## éªŒè¯é€»è¾‘

è„šæœ¬å†…ç½® `check_timestamps_ordered()` å‡½æ•°ï¼Œæå–æ¯è¡Œæœ«å°¾çš„ `[MM:SS]` æˆ– `[HH:MM:SS]`ï¼Œæ£€æŸ¥æ˜¯å¦ä¸¥æ ¼é€’å¢ï¼ˆ`t[i] < t[i+1]`ï¼‰ã€‚

- **âœ… æœ‰åº**ï¼šæ‰€æœ‰æ—¶é—´æˆ³ä¾æ¬¡å¢å¤§
- **âš ï¸ ä¹±åº**ï¼šå­˜åœ¨æ—¶é—´å€’é€€ï¼Œè¯´æ˜ AI æœªéµå®ˆ prompt çº¦æŸï¼ˆåå¤„ç†æ’åºåº”å…œåº•å¤„ç†ï¼Œè‹¥ä»ä¹±åºéœ€æ’æŸ¥ `processor.py`ï¼‰

---

## ç›¸å…³æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `backend/processor.py` â†’ `summarize_text()` | æ‘˜è¦ç”Ÿæˆå‡½æ•°ï¼ŒåŒ…å« prompt å’Œåå¤„ç†æ’åº |
| `backend/scripts/update_recent_summaries.py` | åŒç±»è„šæœ¬ï¼ˆæ—©æœŸç‰ˆæœ¬ï¼Œä»…è¯»æœ¬åœ° JSONï¼Œæ— éªŒè¯ï¼‰ |

---

## ä½•æ—¶è¿è¡Œ

- ä¿®æ”¹ `summarize_text` çš„ prompt åï¼Œå¯¹å†å²æ•°æ®è¡¥è·‘
- å‘ç°æŸæ‰¹è§†é¢‘æ‘˜è¦è´¨é‡å¼‚å¸¸æ—¶ï¼Œæ‰¹é‡é‡åˆ·
- æ—¥å¸¸å›å½’éªŒè¯ï¼š`--dry-run` æ£€æŸ¥ç”Ÿæˆç»“æœæ˜¯å¦ç¬¦åˆé¢„æœŸ
